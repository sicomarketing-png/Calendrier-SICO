<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Calendrier de l'Avent S.I.C.O.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Polices -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Handlee&family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --sico-red:#e53935;
      --sico-green:#3e8759;
      --sico-brown:#9f532a;
      --text-main:#244148;
      --text-soft:#6b7280;
      --shadow-soft:0 16px 40px rgba(15,23,42,.25);
      --line-soft:#e6e8ec;
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:#f4f6f8;color:var(--text-main);
      font-family:"Montserrat",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      display:flex;align-items:center;justify-content:center;padding:24px 16px;min-height:100vh;overflow-x:hidden
    }
    body.no-scroll{overflow:hidden}
    .wrap{
      width:100%;max-width:980px;background:#fff;border-radius:32px;padding:0 28px 26px;
      box-shadow:var(--shadow-soft);border:1px solid rgba(209,213,219,.9);position:relative;overflow:hidden
    }
    .logo{position:absolute;top:18px;right:26px;z-index:3}
    .logo img{width:min(210px,32vw);height:auto;display:block}
    .branch{width:calc(100% + 56px);margin:0 -28px;line-height:0}
    .branch img{width:60%;max-width:640px;display:block}
    header{display:grid;grid-template-columns:minmax(0,3fr) minmax(0,2.3fr);gap:8px 24px;margin-top:0}
    h1{font-family:"Filmotype Honey","Handlee",cursive;font-weight:400;color:var(--sico-green);
      font-size:clamp(2.05rem,2.8vw,2.4rem);margin:10px 0 8px}
    .intro{color:var(--text-soft);max-width:560px;line-height:1.5}
    .hero{justify-self:end}.hero img{max-width:260px;width:100%;height:auto;display:block}
    .meta{margin-top:14px;display:flex;flex-direction:column;gap:6px;align-items:center}
    .pill{display:inline-flex;align-items:center;gap:10px;padding:9px 26px;border-radius:999px;border:1px solid var(--sico-brown);
      color:var(--sico-brown);font-weight:600;font-size:.95rem;background:#fff;box-shadow:0 8px 16px rgba(148,81,39,.18)}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--sico-brown)}
    #calendar-info{font-size:.8rem;color:var(--text-soft)}
    .grid{margin-top:18px;padding:12px 10px 4px;background:#fff;border-radius:24px;border:1px solid rgba(209,213,219,.9);
      display:grid;grid-template-columns:repeat(8,minmax(68px,1fr));gap:8px}
    .cell{position:relative;border:2px solid var(--sico-brown);border-radius:16px;background:#fff;height:95px;padding:6px;
      display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;transition:.18s ease-out}
    .cell:hover{transform:translateY(-2px);box-shadow:0 6px 15px rgba(15,23,42,.16);background:#fffdf7}
    .num{position:absolute;top:-1px;left:-1px;background:var(--sico-brown);color:#fff;font-weight:700;font-size:.9rem;padding:5px 12px;border-radius:14px 0 14px 0}
    .icon{width:82%;max-height:82%;object-fit:contain;margin-top:10px;pointer-events:none}
    .locked{cursor:default;background:#fafafa;opacity:.7}.locked .num{background:#c4c4c4}
    .locked::after{content:"üîí";position:absolute;top:4px;right:7px;font-size:.78rem}
    footer{margin-top:16px;display:flex;justify-content:space-between;gap:8px;flex-wrap:wrap;color:var(--text-soft);font-size:.8rem}
    .legend{display:flex;gap:10px;flex-wrap:wrap}
    .ld{width:10px;height:10px;border-radius:999px;border:1px solid #9ca3af;background:#f3f4f6}
    .ld.open{border-color:#3e8759;background:#dcfce7}
    .chip{padding:4px 10px;border-radius:999px;border:1px dashed rgba(209,213,219,.9);background:#f9fafb}

    /* MODALE */
    .modal{position:fixed;inset:0;background:rgba(15,23,42,.35);display:flex;align-items:center;justify-content:center;padding:16px;z-index:50}
    .hidden{opacity:0;pointer-events:none}
    .card{background:#fff;border-radius:18px;padding:18px 16px 16px;max-width:740px;width:100%;
      box-shadow:0 20px 40px rgba(15,23,42,.45);border:1px solid rgba(229,231,235,.95)}
    .mhead{display:flex;justify-content:space-between;gap:10px}
    .mtitle{font-weight:700}
    .msub{color:var(--text-soft);font-size:.9rem}
    .close{border:none;border-radius:999px;width:30px;height:30px;background:#f3f4f6;cursor:pointer}
    .mbody{margin-top:12px;padding:12px;border:1px solid #e5e7eb;border-radius:14px;background:#f9fafb;max-height:min(520px,80vh);overflow:auto}

    /* Blocs de jeu g√©n√©riques */
    .section + .section{margin-top:14px;padding-top:12px;border-top:1px dashed #d1d5db}
    .tag{display:inline-flex;padding:2px 8px;border:1px dashed #d1d5db;border-radius:999px;background:#f9fafb;color:var(--text-soft);font-size:.75rem;margin-bottom:6px}
    .intro2{color:var(--text-soft);font-size:.9rem;margin-bottom:8px}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
    .in{flex:1;min-width:0;border:1px solid #d1d5db;border-radius:999px;padding:7px 10px;background:#fff}
    .btn{border:none;border-radius:999px;padding:7px 13px;font-weight:600;cursor:pointer;background:linear-gradient(135deg,var(--sico-red),#b91c1c);color:#fff}
    .btn2{border:1px solid #d1d5db;background:#fff;color:#111827}
    .fb{margin-top:4px}.good{color:#166534}.bad{color:#b91c1c}

    /* SUDOKU ‚Äî style maquette (plus de bordures √©paisses √† droite/au bas) */
    .sudoku{display:grid;gap:0;background:#fff;border:1px solid var(--line-soft);padding:2px;inline-size:fit-content}
    .s-row{display:flex}
    .sudoku input{
      width:36px;height:36px;text-align:center;border:1px solid var(--line-soft);border-radius:0;font-weight:700;color:#3b3b3b;background:#fff
    }
    .sudoku input.given{background:#f3f4f6;color:#4a4a4a}
    .thick-b{border-bottom:3px solid var(--sico-brown)!important}
    .thick-r{border-right:3px solid var(--sico-brown)!important}

    /* Crossword mini (formulaire) */
    .cw-form .line{margin-bottom:10px}
    .cw-form .line .tag{margin-bottom:6px}

    /* Mot cas√© (lettre par case) */
    .wordfit-letters{display:flex;gap:8px;flex-wrap:wrap}
    .letter{
      width:36px;height:36px;border:1px solid #d1d5db;border-radius:8px;background:#fff;text-align:center;font-weight:700;font-size:1rem
    }

    /* Iframe integr√© */
    .iframe-wrap iframe{width:100%;height:520px;border:0;border-radius:12px;background:#fff}

    @media (max-width:900px){
      header{grid-template-columns:minmax(0,1.4fr) minmax(0,1fr)}
      .hero img{max-width:230px}.grid{grid-template-columns:repeat(6,minmax(68px,1fr))}
      .logo img{width:160px}
    }
    @media (max-width:720px){
      .wrap{padding:0 16px 20px;border-radius:26px}
      header{grid-template-columns:1fr}.hero{justify-self:center}
      .hero img{max-width:220px}
      .grid{grid-template-columns:repeat(4,minmax(72px,1fr));padding-inline:8px}
    }
    @media (max-width:480px){.grid{grid-template-columns:repeat(3,1fr)}}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Logo -->
    <div class="logo">
      <img src="Logo_SICO_sanspicto-vert_Plan%20de%20travail%201.png" alt="S.I.C.O.">
    </div>

    <!-- Branche -->
    <div class="branch">
      <img src="branche-sapin.png" alt="D√©cor sapin">
    </div>

    <header>
      <div>
        <h1>Calendrier de l‚Äôavent S.I.C.O.</h1>
        <p class="intro">Une petite parenth√®se enchant√©e par jour jusqu‚Äô√† No√´l : 24 mini-jeux pour faire travailler les m√©ninges, s‚Äô√©vader deux minutes et glisser un peu de magie dans la journ√©e. ‚ú®</p>
      </div>
      <div class="hero"><img src="Mascotte-sapin.png" alt="Mascotte"></div>
    </header>

    <div class="meta">
      <div class="pill"><span class="dot"></span><span id="today"></span></div>
      <span id="calendar-info"></span>
    </div>

    <!-- GRILLE 8 x 3 -->
    <section class="grid" aria-label="Calendrier de l'Avent S.I.C.O.">
      <!-- 1..24 -->
      <button type="button" class="cell" data-day="1"><span class="num">1</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="2"><span class="num">2</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="3"><span class="num">3</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="4"><span class="num">4</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="5"><span class="num">5</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="6"><span class="num">6</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="7"><span class="num">7</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="8"><span class="num">8</span><img class="icon" src="Image calendrier-03.png" alt=""></button>

      <button type="button" class="cell" data-day="9"><span class="num">9</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="10"><span class="num">10</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="11"><span class="num">11</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="12"><span class="num">12</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="13"><span class="num">13</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="14"><span class="num">14</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="15"><span class="num">15</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="16"><span class="num">16</span><img class="icon" src="Image calendrier-02.png" alt=""></button>

      <button type="button" class="cell" data-day="17"><span class="num">17</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="18"><span class="num">18</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="19"><span class="num">19</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="20"><span class="num">20</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="21"><span class="num">21</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
      <button type="button" class="cell" data-day="22"><span class="num">22</span><img class="icon" src="Image calendrier-02.png" alt=""></button>
      <button type="button" class="cell" data-day="23"><span class="num">23</span><img class="icon" src="Image calendrier-03.png" alt=""></button>
      <button type="button" class="cell" data-day="24"><span class="num">24</span><img class="icon" src="Image calendrier-04.png" alt=""></button>
    </section>

    <footer>
      <div class="legend">
        <span><span class="ld open"></span> Cases accessibles</span>
        <span><span class="ld"></span> Cases encore √† venir</span>
      </div>
      <div class="chip">Mini-jeux de 2‚Äì3 minutes, √† d√©gainer en pause caf√© ‚òï</div>
    </footer>
  </div>

  <!-- MODALE -->
  <div id="modal" class="modal hidden" aria-modal="true" role="dialog">
    <div class="card">
      <div class="mhead">
        <div>
          <div class="mtitle" id="g-title"></div>
          <div class="msub" id="g-sub"></div>
        </div>
        <button class="close" id="g-close" aria-label="Fermer">‚úï</button>
      </div>
      <div class="mbody"><div id="game"></div></div>
    </div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const TEST_MODE = false; // true pour tout d√©bloquer
    const todayEl = document.getElementById("today");
    const infoEl = document.getElementById("calendar-info");
    const cells = document.querySelectorAll(".cell");
    const modal = document.getElementById("modal");
    const game = document.getElementById("game");
    const gTitle = document.getElementById("g-title");
    const gSub = document.getElementById("g-sub");
    const closeBtn = document.getElementById("g-close");

    const now = new Date();
    const isDecember = now.getMonth() === 11;
    if (todayEl) {
      todayEl.textContent = "Nous sommes le " + now.toLocaleDateString("fr-FR",{weekday:"long",day:"2-digit",month:"long",year:"numeric"});
    }
    const maxOpen = (TEST_MODE || !isDecember) ? 24 : Math.min(now.getDate(), 24);
    if (infoEl) {
      infoEl.textContent = (TEST_MODE || !isDecember)
        ? "Mode d√©mo : toutes les cases sont ouvertes. En d√©cembre, l'ouverture est limit√©e au jour J."
        : "Tu peux ouvrir les cases du 1 au " + maxOpen + " d√©cembre.";
    }

    /* CONFIG demand√©e (case 7 = mot cas√©, case 18 = mots crois√©s) */
    const cfg = {
      1:  {type:"guess",    subtitle:"Devine le nombre (1‚Äì10)", max:10, attempts:3},
      2:  {type:"anagrams", subtitle:"Anagrammes faciles √ó3", words:["NOEL","SAPIN","RENNE","NEIGE","ETOILE","ANGE"], count:3},
      3:  {type:"puzzle",   subtitle:"Suite logique (facile)", sequences:[{question:"2, 4, 6, ?",answer:"8"},{question:"1, 1, 2, 3, 5, ?",answer:"8"},{question:"3, 6, 9, 12, ?",answer:"15"}]},
      4:  {type:"sudoku4",  subtitle:"Mini-sudoku 4√ó4"},
      5:  {type:"memory",   subtitle:"M√©mo 8 cartes", icons:["üéÑ","‚ùÑÔ∏è","üéÅ","üß£"]},
      6:  {type:"math",     subtitle:"Calcul mental (5 questions)"},
      7:  {type:"wordfitOne", subtitle:"Mot cas√© ‚Äì sp√©cial cabane", clue:"Petite habitation mis√©rable", answer:"cahute"},
      8:  {type:"embed",    subtitle:"Cadenas n¬∞1", url:"cadenas1.html"},
      9:  {type:"sudoku9",  subtitle:"Sudoku 9√ó9 ‚Äì simple", difficulty:"easy"},
      10: {type:"math",     subtitle:"Calcul mental (5 questions)"},
      11: {type:"riddle",   subtitle:"Devinette", riddles:[{question:"Je tombe en hiver mais je ne me fais pas mal. Qui suis-je ?", answer:"neige"}]},
      12: {type:"anagrams", subtitle:"Anagrammes difficiles √ó3", words:["CHOCOLAT","GUIRLANDE","CHEMINEE","TRAINEAU","CADEAUX","BISCUITS"], count:3},
      13: {type:"guess",    subtitle:"Devine le nombre (1‚Äì50)", max:50, attempts:7},
      14: {type:"embed",    subtitle:"Cadenas n¬∞2", url:"cadenas2.html"},
      15: {type:"sudoku9",  subtitle:"Sudoku 9√ó9 ‚Äì moyen", difficulty:"medium"},
      16: {type:"memory",   subtitle:"M√©mo 8 cartes", icons:["üïØÔ∏è","‚òï","üß¶","üç™"]},
      17: {type:"riddle",   subtitle:"Devinettes du feu de chemin√©e", riddles:[
            {question:"Je cr√©pite dans le foyer et je r√©chauffe la pi√®ce.", answer:"feu"},
            {question:"On me boit chaud, avec du chocolat et parfois de la chantilly.", answer:"chocolat chaud"}
          ]},
      18: {type:"crosswordForm", subtitle:"Mots crois√©s cocooning", words:[
            {clue:"Boisson chaude au cacao", answer:"chocolatchaud"},
            {clue:"On les met aux pieds quand il fait froid", answer:"chaussettes"},
            {clue:"On y allume parfois un feu", answer:"cheminee"}
          ]},
      19: {type:"guess",    subtitle:"Devine le nombre (1‚Äì100)", max:100, attempts:8},
      20: {type:"puzzle",   subtitle:"Suites logiques (difficiles)", sequences:[
            {question:"4, 9, 16, 25, ?", answer:"36"},
            {question:"2, 3, 5, 7, 11, ?", answer:"13"},
            {question:"1, 2, 4, 7, 11, ?", answer:"16"}
          ]},
      21: {type:"sudoku9",  subtitle:"Sudoku 9√ó9 ‚Äì difficile", difficulty:"hard"},
      22: {type:"memory",   subtitle:"M√©mo 12 cartes", icons:["üéÑ","üéÅ","üß¶","‚òï","üïØÔ∏è","üç™"]},
      23: {type:"embed",    subtitle:"Cadenas n¬∞3", url:"cadenas3.html"},
      24: {type:"embed",    subtitle:"Grand mot cas√©", url:"grand-mot-case.html"}
    };

    // Clics + verrous
    cells.forEach(btn=>{
      const d = +btn.dataset.day;
      if(d <= maxOpen){ btn.addEventListener("click",()=>open(d)); }
      else{ btn.classList.add("locked"); btn.addEventListener("click",()=>alert("Patience ! La case "+d+" s‚Äôouvre le "+d+" d√©cembre.")); }
    });

    function showModal(){ modal.classList.remove("hidden"); document.body.classList.add("no-scroll"); }
    function closeModal(){ modal.classList.add("hidden"); document.body.classList.remove("no-scroll"); game.innerHTML=""; }
    closeBtn.addEventListener("click", closeModal);
    modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });

    function open(day){
      const c = cfg[day] || {};
      gTitle.textContent = "Case n¬∞"+day+" üéÅ";
      gSub.textContent = c.subtitle || "Mini-jeu";
      game.innerHTML = "";

      switch(c.type){
        case "guess":        renderGuess(game,c); break;
        case "anagrams":     renderAnagrams(game,c); break;
        case "puzzle":       renderPuzzle(game,c); break;
        case "sudoku4":      renderSudoku(game,{size:4}); break;
        case "sudoku9":      renderSudoku(game,{size:9, difficulty:c.difficulty||"easy"}); break;
        case "memory":       renderMemory(game,c); break;
        case "math":         renderMath(game,c); break;
        case "riddle":       renderRiddles(game,c); break;
        case "crosswordForm":renderCrosswordForm(game,c); break;
        case "wordfitOne":   renderWordFitOne(game,c); break;
        case "embed":        renderEmbed(game,c.url); break;
        default: game.textContent="Mini-jeu en pr√©paration‚Ä¶";
      }
      showModal();
    }

    /* ===== util UI ===== */
    function el(tag,cls,txt){ const n=document.createElement(tag); if(cls) n.className=cls; if(txt!=null) n.textContent=txt; return n; }
    function makeSection(title){ const s=el("section","section"); if(title) s.append(el("div","tag",title)); return s; }
    function rand(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
    function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} }
    function mix(word){ const arr=word.replace(/\s+/g,"").split(""); for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr.join("").toUpperCase(); }
    const strip = s => (s||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"");

    /* ===== MINI-JEUX ===== */

    // 1) Devine le nombre
    function renderGuess(container, cfg){
      const max=cfg.max||10, tries=cfg.attempts||3, secret=Math.floor(Math.random()*max)+1;
      let left=tries, done=false;
      const sec=makeSection("Devine le nombre");
      sec.append(el("p","intro2","Je pense √† un nombre entre 1 et "+max+". Tu as "+tries+" essai(s)."));
      const row=el("div","row"); const inp=el("input","in"); inp.type="number"; inp.min=1; inp.max=max; inp.placeholder="Ta proposition‚Ä¶";
      const btn=el("button","btn"); btn.textContent="Valider";
      const fb=el("p","fb"); const sc=el("p","intro2"); sc.textContent="Essais restants : "+left;
      btn.onclick=()=>{ if(done) return; const v=parseInt(inp.value,10);
        if(!v || v<1 || v>max){ fb.className="fb bad"; fb.textContent="Nombre entre 1 et "+max+" attendu."; return; }
        if(v===secret){ fb.className="fb good"; fb.innerHTML="Bravo ‚ú® !"; btn.disabled=inp.disabled=true; done=true; sc.textContent="Partie termin√©e."; }
        else{ left--; if(left<=0){ fb.className="fb bad"; fb.innerHTML="Perdu‚Ä¶ c‚Äô√©tait <b>"+secret+"</b>."; btn.disabled=inp.disabled=true; sc.textContent="Essais restants : 0"; }
              else{ fb.className="fb"; fb.textContent=(v<secret?"C‚Äôest plus grand.":"C‚Äôest plus petit."); sc.textContent="Essais restants : "+left; } }
      };
      row.append(inp,btn); sec.append(row,fb,sc); container.append(sec);
    }

    // 2 / 12) Anagrammes √ó3
    function renderAnagrams(container, cfg){
      const pool=(cfg.words||[]).slice(); shuffle(pool); const n=Math.min(cfg.count||3, pool.length);
      const chosen=pool.slice(0,n);
      const sec=makeSection("Anagrammes");
      sec.append(el("p","intro2","Retrouve les mots li√©s √† l‚Äôhiver / No√´l."));
      const form=el("form"); const fb=el("p","fb");
      chosen.forEach((w,i)=>{ const wrap=el("div","section");
        wrap.append(el("div","tag","Mot "+(i+1)+" : "+mix(w)));
        const row=el("div","row"); const inp=el("input","in"); inp.type="text"; inp.placeholder="Ta proposition‚Ä¶"; inp.dataset.answer=strip(w);
        row.append(inp); wrap.append(row); form.append(wrap);
      });
      const r=el("div","row"); const btn=el("button","btn"); btn.type="submit"; btn.textContent="Valider toutes"; r.append(btn); form.append(r,fb);
      form.onsubmit=(e)=>{e.preventDefault(); let ok=0; form.querySelectorAll("input.in").forEach(i=>{ if(strip(i.value)===i.dataset.answer) ok++; });
        fb.className="fb "+(ok>=Math.ceil(n/2)?"good":"bad"); fb.innerHTML="R√©sultat : <b>"+ok+"</b> / "+n+" bon(s) mot(s)."; };
      container.append(sec,form);
    }

    // 3 / 20) Suites logiques
    function renderPuzzle(container, cfg){
      const seq=cfg.sequences||[]; const sec=makeSection("Suites logiques");
      sec.append(el("p","intro2","Compl√®te les suites de nombres. Cherche la logique !"));
      const form=el("form"); const fb=el("p","fb");
      seq.forEach((s,i)=>{ const b=el("div","section"); b.append(el("div","tag","Suite "+(i+1)+" : "+s.question));
        const row=el("div","row"); const inp=el("input","in"); inp.type="number"; inp.placeholder="Nombre manquant‚Ä¶"; inp.dataset.answer=(s.answer||"").trim();
        row.append(inp); b.append(row); form.append(b);
      });
      const rb=el("div","row"); const btn=el("button","btn"); btn.type="submit"; btn.textContent="Valider"; rb.append(btn); form.append(rb,fb);
      form.onsubmit=(e)=>{e.preventDefault(); let ok=0; form.querySelectorAll("input.in").forEach(i=>{ if((i.value||"").trim()===(i.dataset.answer||"")) ok++; });
        fb.className="fb "+(ok>=Math.ceil(seq.length/2)?"good":"bad"); fb.innerHTML="Tu as compl√©t√© <b>"+ok+"</b> / "+seq.length+"."; };
      container.append(sec,form);
    }

    // 4 / 9 / 15 / 21) Sudoku (corrig√© : traits √©pais internes seulement)
    function renderSudoku(container,{size=9,difficulty="easy"}){
      const base = makeSudokuSolution(size);
      const puzzle = makeSudokuPuzzle(base,size,difficulty);
      const title = size===4 ? "Mini-sudoku 4√ó4" : "Sudoku 9√ó9";
      const sec=makeSection(title);
      const txt = size===4
        ? "Remplis la grille avec les chiffres 1 √† 4. Chaque ligne, chaque colonne et chaque carr√© doit contenir tous les chiffres une seule fois."
        : "Remplis la grille avec les chiffres 1 √† 9. Chaque ligne, chaque colonne et chaque carr√© doit contenir tous les chiffres une seule fois.";
      sec.append(el("p","intro2",txt));

      const grid=el("div","sudoku");
      const block = (size===9)?3:2; // taille des sous-grilles
      for(let r=0;r<size;r++){
        const row=el("div","s-row");
        for(let c=0;c<size;c++){
          const v=puzzle[r][c]; const inp=document.createElement("input");
          inp.maxLength=1; inp.inputMode="numeric"; inp.dataset.r=r; inp.dataset.c=c;
          if(v){ inp.value=v; inp.readOnly=true; inp.classList.add("given"); }
          // >>> traits √©pais uniquement ENTRE les blocs (pas sur les bords ext√©rieurs)
          if ((c+1)%block===0 && c!==size-1) inp.classList.add("thick-r");
          if ((r+1)%block===0 && r!==size-1) inp.classList.add("thick-b");
          row.append(inp);
        }
        grid.append(row);
      }

      const actions=el("div","row");
      const check=el("button","btn"); check.textContent="V√©rifier";
      const reset=el("button","btn btn2"); reset.textContent="R√©initialiser";
      const fb=el("p","fb");
      check.onclick=()=>{ const ok=validateSudokuInputs(grid,base); fb.className="fb "+(ok?"good":"bad"); fb.textContent= ok ? "Bravo, c‚Äôest correct !" : "Il reste des erreurs‚Ä¶"; };
      reset.onclick=()=>{ grid.querySelectorAll("input:not(.given)").forEach(i=>i.value=""); fb.textContent=""; };

      actions.append(check,reset);
      container.append(sec,grid,actions,fb);
    }
    function makeSudokuSolution(n){
      if(n===9){ const row=[1,2,3,4,5,6,7,8,9]; const g=Array.from({length:9},()=>Array(9).fill(0));
        const pattern=(r,c)=>((r*3+Math.floor(r/3)+c)%9);
        for(let r=0;r<9;r++) for(let c=0;c<9;c++) g[r][c]=row[pattern(r,c)]; return g;
      } else { const row=[1,2,3,4]; const g=Array.from({length:4},()=>Array(4).fill(0));
        const pattern=(r,c)=>((r*2+Math.floor(r/2)+c)%4);
        for(let r=0;r<4;r++) for(let c=0;c<4;c++) g[r][c]=row[pattern(r,c)]; return g; }
    }
    function makeSudokuPuzzle(sol,n,level){
      const total=n*n; let givens;
      if(n===4){ givens=10; }
      else { givens = (level==="easy")?45 : (level==="medium")?35 : 28; }
      const reveal=new Set(); while(reveal.size<givens){ reveal.add(Math.floor(Math.random()*total)); }
      const puz=Array.from({length:n},()=>Array(n).fill(0));
      [...reveal].forEach(idx=>{ const r=Math.floor(idx/n), c=idx%n; puz[r][c]=sol[r][c]; });
      return puz;
    }
    function validateSudokuInputs(grid,sol){
      const inputs=grid.querySelectorAll("input");
      for(const i of inputs){ const r=+i.dataset.r, c=+i.dataset.c; const v=parseInt(i.value||"0",10); if(v!==sol[r][c]) return false; }
      return true;
    }

    // 5 / 16 / 22) M√©mo
    function renderMemory(container, cfg){
      const icons=(cfg.icons||["üéÑ","üéÅ","üß¶","‚òï"]).slice();
      const pairs = icons.concat(icons);
      shuffle(pairs);
      const sec=makeSection("M√©mo"); sec.append(el("p","intro2","Retourne les cartes pour retrouver les paires."));
      const grid=el("div"); grid.style.display="grid"; grid.style.gridTemplateColumns="repeat(4,minmax(0,1fr))"; grid.style.gap="8px";
      const status=el("p","intro2");
      let first=null, lock=false, found=0, moves=0;
      function update(){ status.textContent="Paires trouv√©es : "+found+" / "+icons.length+" ‚Äî Coups : "+moves; }
      pairs.forEach(icon=>{ const b=document.createElement("button"); b.type="button"; styleCard(b); b.textContent="‚ùÑÔ∏è"; b.dataset.icon=icon;
        b.onclick=()=>{ if(lock||b.disabled)return; b.textContent=icon; b.style.background="#fff7ed";
          if(!first){ first=b; } else { lock=true; moves++;
            if(first.dataset.icon===b.dataset.icon && first!==b){ setTimeout(()=>{ first.disabled=b.disabled=true; first.style.opacity=b.style.opacity=".6"; first.style.background=b.style.background="#ecfdf3"; found++; first=null; lock=false; update(); },380); }
            else{ setTimeout(()=>{ first.textContent=b.textContent="‚ùÑÔ∏è"; first.style.background=b.style.background="#fff"; first=null; lock=false; update(); },480); }
          }
        };
        grid.append(b);
      });
      update(); container.append(sec,grid,status);
    }
    function styleCard(btn){
      btn.style.borderRadius="12px"; btn.style.border="1px solid #d1d5db"; btn.style.height="64px";
      btn.style.display="flex"; btn.style.alignItems="center"; btn.style.justifyContent="center";
      btn.style.fontSize="1.6rem"; btn.style.background="#fff"; btn.style.cursor="pointer";
    }

    // 6 / 10) Calcul mental (‚ÄúQuestion 1/5 ‚Üí‚Äù)
    function renderMath(container){
      const count=5; const ops=["+","-","√ó"]; const qs=[];
      for(let i=0;i<count;i++){ const a=rand(1,12), b=rand(1,12), op=ops[rand(0,ops.length-1)];
        const sol=(op==="+")?a+b:(op==="-")?a-b:a*b; qs.push({a,b,op,sol}); }
      let idx=0, score=0;
      const sec=makeSection("Calcul mental"); const title=el("p","intro2");
      const row=el("div","row"); const inp=el("input","in"); inp.type="number"; inp.placeholder="R√©ponse‚Ä¶";
      const btn=el("button","btn"); btn.textContent="Valider"; const fb=el("p","fb"); const sc=el("p","intro2");
      function show(){ const q=qs[idx]; title.textContent="Question "+(idx+1)+"/"+count+" ‚Üí  "+q.a+" "+q.op+" "+q.b+" = ?"; inp.value=""; inp.focus(); sc.textContent="Score provisoire : "+score; }
      function submit(){ const q=qs[idx]; const v=parseInt(inp.value||"NaN",10);
        if(v===q.sol){ score++; fb.className="fb good"; fb.textContent="‚úÖ Parfait !"; } else { fb.className="fb bad"; fb.textContent="‚ùå La bonne r√©ponse √©tait "+q.sol; }
        idx++; if(idx>=count){ btn.disabled=inp.disabled=true; sc.textContent="R√©sultat final : "+score+" / "+count; } else show();
      }
      btn.onclick=submit; inp.onkeydown=(e)=>{ if(e.key==="Enter") submit(); };
      row.append(inp,btn); sec.append(title,row,fb,sc); container.append(sec); show();
    }

    // 11 / 17) Devinettes
    function renderRiddles(container, cfg){
      const sec=makeSection("Devinettes"); const form=el("form"); const fb=el("p","fb");
      (cfg.riddles||[]).forEach((r)=>{ const b=el("div","section"); b.append(el("div","tag","üëâ "+r.question));
        const row=el("div","row"); const inp=el("input","in"); inp.type="text"; inp.placeholder="Ta r√©ponse‚Ä¶"; inp.dataset.answer=strip(r.answer);
        row.append(inp); b.append(row); form.append(b);
      });
      const rb=el("div","row"); const btn=el("button","btn"); btn.type="submit"; btn.textContent="V√©rifier"; rb.append(btn); form.append(rb,fb);
      form.onsubmit=(e)=>{e.preventDefault(); let good=0; form.querySelectorAll("input.in").forEach(inp=>{ if(strip(inp.value)===inp.dataset.answer) good++; });
        fb.className="fb "+(good? "good":"bad"); fb.innerHTML="Tu en as trouv√© <b>"+good+"</b> / "+(cfg.riddles||[]).length+"."; };
      container.append(sec,form);
    }

    // 18) Mots crois√©s cocooning ‚Äî formulaire
    function renderCrosswordForm(container, cfg){
      const sec=makeSection("Mini mots crois√©s");
      sec.append(el("p","intro2","Compl√®te les mots √† partir des d√©finitions. √âcris-les sans accents ni majuscules (ex. : noel)."));
      const form=el("form"); form.className="cw-form"; const fb=el("p","fb");
      (cfg.words||[]).forEach((w,idx)=>{
        const line=el("div","line");
        const len=strip(w.answer).length;
        line.append(el("div","tag","Mot "+(idx+1)+" ("+len+" lettre(s)) ‚Äî "+w.clue));
        const input=el("input","in"); input.type="text"; input.placeholder="Ta r√©ponse‚Ä¶"; input.dataset.answer=strip(w.answer);
        line.append(input); form.append(line);
      });
      const rb=el("div","row"); const btn=el("button","btn"); btn.type="submit"; btn.textContent="V√©rifier mes mots"; rb.append(btn); form.append(rb,fb);
      form.onsubmit=(e)=>{e.preventDefault(); let ok=0; form.querySelectorAll("input.in").forEach(i=>{ if(strip(i.value)===i.dataset.answer) ok++; });
        fb.className="fb "+(ok>=2?"good":"bad"); fb.innerHTML="R√©sultat : <b>"+ok+"</b> / "+(cfg.words||[]).length+" mot(s) correct(s)."; };
      container.append(sec,form);
    }

    // 7) Mot cas√© ‚Äî 1 mot
    function renderWordFitOne(container, cfg){
      const answer = strip(cfg.answer||"");
      const sec=makeSection("Mot cas√©");
      const tag=el("div","tag",cfg.clue||"D√©finition");
      const intro=el("p","intro2","Retrouve le mot √† partir de la d√©finition, puis remplis les cases (1 lettre par case).");
      const boxes=el("div","wordfit-letters");
      const inputs=[];
      for(let i=0;i<answer.length;i++){
        const inp=document.createElement("input"); inp.className="letter"; inp.maxLength=1; inp.inputMode="latin"; boxes.append(inp); inputs.push(inp);
      }
      const rb=el("div","row"); const btn=el("button","btn"); btn.textContent="V√©rifier le mot";
      const fb=el("p","fb");
      btn.onclick=()=>{ const guess=strip(inputs.map(i=>i.value).join("")); if(guess===answer){ fb.className="fb good"; fb.textContent="Bravo !"; } else { fb.className="fb bad"; fb.textContent="Pas encore‚Ä¶"; } };
      rb.append(btn); sec.append(tag,intro,boxes,rb,fb); container.append(sec);
    }

    // 8/14/23/24) Iframe (cadenas & grand mot-cas√©)
    function renderEmbed(container, url){
      const sec=makeSection("Jeu externe int√©gr√©");
      const wrap=el("div","iframe-wrap");
      const iframe=document.createElement("iframe"); iframe.src=url;
      wrap.append(iframe); sec.append(wrap); container.append(sec);
    }
  });
  </script>
</body>
</html>
